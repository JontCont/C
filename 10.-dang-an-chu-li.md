# 10. 檔案處理

檔案是眾多的字元所組成的集合體，部分語言會將它視為一種資料串流\(Stream\)。  
與資料串流有關的資訊，是記錄在一個資料型態為資料串流列別的資料串流物件變數，作用為資料串流與檔案的溝通橋樑。

所以檔案處理也能稱作是資料串流處理。資料串流類別分成三種【資料輸入串流類別\(ifsteam\)】、【資料輸出串流類別\(ofsteam\)】、【資料輸入/輸出串流類別\(fsteam\)】。

## 檔案類型

### 一、文字檔

文字檔以列為單位，列與列之間為 '\n' 字元；資料中每一個字元，以對應的ASCII碼來儲存。

### 二、二進位檔

二進位 檔裡面沒有額外的 '\n' 字元 ; 資料中每一個字元都直接以二進制的格式存取。例如執行檔、圖片、影片等，但二進制是無法使用在文字編輯軟體處理，若強制開啟會遇到亂碼。

![](.gitbook/assets/image%20%2844%29.png)

檔案依存取權限，可分為一般檔案與唯讀檔 \(read-only\)，檢視方式對文件按下右鍵，是否有勾起屬性中的唯獨。

![](.gitbook/assets/image%20%2843%29.png)

## 檔案存取

存取方式分為兩種，循序存取、隨機存取。

### 一、循序存取\(sequential access\)

意指一組序列（例如存於記憶數組、磁盤軟體或是磁帶中的資料）是以預先安排，有秩序的方式被人存取。循序存取有時只是唯一的存取數據方式，磁帶即屬一例。循序存取亦有可能成為有選擇性的方式，就如我們純粹有意順序處理一組資料元件。

資料寫入檔案時，附加檔案尾端，讀取時，由檔案的開端由前往後一個字元一個字元讀出。常見於文字檔方式。

### 二、隨機存取\(random access\)

 又稱**直接存取**（direct access），代表同一時間存取一組序列中的一個隨意元件。反之則稱[循序存取](https://zh.wikipedia.org/wiki/%E5%BE%AA%E5%BA%8F%E5%AD%98%E5%8F%96)，即是需要更多時間去存取一個遠端元件。介分兩者的傳統圖解就似比較一軸古代畫卷（循序︰所有在元件之前的物料必須事先捲開）及一本圖書（隨機︰可以隨時翻至任何一頁）。而更近現代的例子就如比較卡式磁帶。

資料是以一筆紀錄\(結構型態\)作為單位寫入檔案，用每一筆紀錄長度相同，可利用目前資料紀錄所在位置，算出實際資料位置並取得資料。常見於二進制檔。

## 有緩衝區與無緩衝區的檔案處理

![](.gitbook/assets/image%20%2842%29.png)

## C語言-範例

### 檔案處理函數 fopen\(\)

{% hint style="info" %}
### 有緩衝區的檔案處理函數 

```c
FILE 指標變數;  /* 宣告指向檔案結構的指標 */ 
指標變數 = fopen("欲開啟檔案名稱", "存取模式");
```
{% endhint %}

![](.gitbook/assets/image%20%2841%29.png)

### 開啟檔案的範例

```c
FILE *fptr; /* 宣告指向檔案的指標fptr */
fptr = fopen("abc.txt","r"); /* 開啟檔案abc.txt以供讀取 */
if(fptr!=NULL) /* 判別檔案是否開啟成功 */
{
   /* 檔案開啟成功時，所要執行的程式碼 */
}
else
{
   /* 檔案開啟失敗時，所要執行的程式碼 */
}
```

### stdio.h 標頭檔中的檔案處理函數

![](.gitbook/assets/image%20%2845%29.png)

![](.gitbook/assets/image%20%2846%29.png)

